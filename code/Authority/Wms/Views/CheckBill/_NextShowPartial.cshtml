<script type="text/javascript">
    function upDivClick() {
        $('#nextShowDiv').dialog('close');
    }

    //生成盘点单
    function generateCheckClick() {
        var tabsRow = $('#checkTabs').tabs('getSelected');
        if (tabsRow.panel('options').id == "cellCheck") {//生成货位盘点数据
            //            $.getJSON('/CheckBill/CheckCellCreate/', { wareCodes: ware, areaCodes: area, shelfCodes: shelf, cellCodes: cell }, function (json) {
            //                if (json) {
            //                    if (json.success) {
            //                        $.messager.show({
            //                            title: '成功',
            //                            msg: json.msg
            //                        });
            //                        $('#nextShowDiv').dialog('close');
            //                        $('#addCheck').dialog('close');
            //                        $('#details').datagrid('load');
            //                    } else {
            //                        $.messager.show({
            //                            title: '错误',
            //                            msg: json.msg
            //                        });
            //                        $('#nextShowDiv').dialog('close');
            //                        $('#details').datagrid('load');
            //                    }
            //                }
            //            });

            var j_waitDialog = ShowWaitMessageDialog();
            $.ajax({
                url: '/CheckBill/CheckCellCreate/', type: "GET", dataType: "text",
                data: { 'wareCodes': ware, 'areaCodes': area, 'shelfCodes': shelf, 'cellCodes': cell },
                complete: function () { HideWaitMessageDialog(j_waitDialog); },
                success: function (responseText) {
                    var result = $.evalJSON(responseText);
                    if (result.success) {
                        $.messager.alert(g_MsgBoxTitle, result.msg, "info");
                        $('#nextShowDiv').dialog('close');
                        $('#addCheck').dialog('close');
                        $('#details').datagrid('load');
                    } else {
                        $.messager.alert(g_MsgBoxTitle, result.msg + '<br />' + result.data, "error");
                    }
                }
            });
        } else if (tabsRow.panel('options').id == "productCheck") {//生成产品盘点数据
            var j_waitDialog = ShowWaitMessageDialog();
            $.ajax({
                url: '/CheckBill/CheckProductCreate/', type: "GET", dataType: "text",
                data: { 'products': productCheckParameter },
                complete: function () { HideWaitMessageDialog(j_waitDialog); },
                success: function (responseText) {
                    var result = $.evalJSON(responseText);
                    if (result.success) {
                        $.messager.alert(g_MsgBoxTitle, result.msg, "info");
                        $('#nextShowDiv').dialog('close');
                        $('#addCheck').dialog('close');
                        $('#details').datagrid('load');
                    } else {
                        $.messager.alert(g_MsgBoxTitle, result.msg + '<br />' + result.data, "error");
                    }
                }
            });
        } else if (tabsRow.panel('options').id == "changedCheck") {//生成异动盘点数据
            var j_waitDialog = ShowWaitMessageDialog();
            $.ajax({
                url: '/CheckBill/CheckChangedCreate/', type: "GET", dataType: "text",
                data: { 'beginDate': begin, 'endDate': end },
                complete: function () { HideWaitMessageDialog(j_waitDialog); },
                success: function (responseText) {
                    var result = $.evalJSON(responseText);
                    if (result.success) {
                        $.messager.alert(g_MsgBoxTitle, result.msg, "info");
                        $('#nextShowDiv').dialog('close');
                        $('#addCheck').dialog('close');
                        $('#details').datagrid('load');
                    } else {
                        $.messager.alert(g_MsgBoxTitle, result.msg + '<br />' + result.data, "error");
                    }
                }
            });
        } else {
            $.messager.alert('错误', '没选择盘点方式！请关闭页面从新打开！');
        }
    }
</script>
<div id="nextShowDiv" class="easyui-dialog" modal="true" closed="true" style="width: 620px; height: 400px; 
    background: #fff; border: 1px solid #ccc;" buttons="#upDiv">
        <table id="nextShowTable" class="easyui-datagrid" border="false" singleselect="true"
            fit="true" pagination="true" rownumbers="true">
            <thead>
                <tr>
                    <th field="CellCode" width="60">
                        货位编码
                    </th>
                    <th field="CellName" width="80">
                        货位名称
                    </th>
                    <th field="StorageCode" width="60">
                        储存编码
                    </th>
                    <th field="ProductCode" width="60">
                        产品编码
                    </th>
                    <th field="ProductName" width="100">
                        产品名称
                    </th>
                    <th field="UnitCode" width="60">
                        单位编码
                    </th>
                    <th field="UnitName" width="60">
                        单位名称
                    </th>
                    <th field="Quantity" width="60">
                        数量
                    </th>
                </tr>
            </thead>
        </table>
 </div>
 <div id="upDiv">
        <a href="#" class="easyui-linkbutton" iconcls="icon-ok" onclick="generateCheckClick()">生成盘点单</a>
        <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="upDivClick()">取消</a>        
</div>
