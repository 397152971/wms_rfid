<script type="text/javascript">

    var data = { "total": 0, "rows": [] };
    var ydata = { "rows": [] };
    var rdata = { "rows": [] };
    //    $(function () {
    //        $.getJSON("/Product/FindProduct/", function (json) {
    //            ydata = json;
    //            $('#productTable').datagrid('loadData', ydata);
    //            
    //        });

    //        $('#productTable').datagrid({
    //            onLoadSuccess: function (data) {
    //                $('#checkProductTable').datagrid({
    //                    singleSelect: true
    //                });
    //                $('.item').draggable({
    //                    revert: true,
    //                    proxy: 'clone',
    //                    onStartDrag: function () {
    //                       // $(this).draggable('options').cursor = 'not-allowed';
    //                        // $(this).draggable('proxy').css('z-index', 10);
    //                        $(this).draggable('options').cursor = 'auto';
    //                        $(this).draggable('proxy').addClass('dp');  
    //                    },
    //                    onStopDrag: function () {
    //                        //$(this).draggable('options').cursor = 'move';
    //                        $(this).draggable('options').cursor = 'auto';  
    //                    }
    //                });
    //                $('.cart').droppable({
    //                    onDragEnter: function (e, source) {
    //                        $(source).draggable('options').cursor = 'auto';
    //                        $(source).draggable('proxy').css('border', '1px solid red');  
    //                    },
    //                    onDragLeave: function (e, source) {
    //                        $(source).draggable('options').cursor = 'not-allowed';
    //                        $(source).draggable('proxy').css('border', '1px solid #ccc');  
    //                    },
    //                    onDrop: function (e, source) {
    //                        var productName = $(source).find('p:eq(0)').html();
    //                        var producrCode = $(source).find('p:eq(1)').html();
    //                        var index = $(source).find('p:eq(2)').html();
    //                        addProduct(producrCode, productName, index);
    //                    }
    //                });
    //            }
    //        });
    //    });

    function addProduct(producrCode, productName, index) {
        function add() {
            data.rows.push({
                ProductCode: producrCode,
                ProductName: productName
            });
        }
        add();
        $('#productTable').datagrid('deleteRow', index);
        $('#checkProductTable').datagrid('loadData', data);
    }

    function formatAction(value, row, index) {
        var s = '<div class="item"><p>' + row.ProductName + '</p><p style="display:none">' + row.ProductCode + '</p><p style="display:none">' + index + '</p></div> ';
        return s;
    }

    function rightMoveClick() {
        var rows = $('#productTable').datagrid('getSelections');
        if (rows.length > 0) {
            for (var i = 0; i < rows.length; i++) {
                var index = $('#productTable').datagrid('getRowIndex', rows[i]);
                $('#productTable').datagrid('deleteRow', index);
                $('#checkProductTable').datagrid('appendRow', rows[i]);
            }
        } else {
            $.messager.confirm('错误', '请选择需要盘点的卷烟移向右边！');
        }
    }

    function leftMoveClick() {
        var rows = $('#checkProductTable').datagrid('getSelections');
        if (rows.length > 0) {
            for (var i = 0; i < rows.length; i++) {
                var index = $('#checkProductTable').datagrid('getRowIndex', rows[i]);
                $('#checkProductTable').datagrid('deleteRow', index);
                $('#productTable').datagrid('appendRow', rows[i]);
            }
        } else {
            $.messager.confirm('错误', '请选择不要盘点的卷烟移向左边！');
        }
    }
</script>
<div id="productCheckDiv" class="easyui-layout" fit="true">
    <div id="leftDiv" border="false" region="west" style="width: 358px; border-right-style: solid;
        border-right-width: 1px;">
        <table id="productTable" class="easyui-datagrid" border="false" url=''
            singleselect="false" fit="true" rownumbers="true">
            <thead>
                <tr>
                    <th field="ck" checkbox="true">
                        <th field="ProductCode" width="120">
                            产品编码
                        </th>
                        <th field="ProductName" width="170">
                            产品名称
                        </th>
                </tr>
            </thead>
        </table>
    </div>
    <div id="rightMoveLeft" border="false" region="center" style="text-align: center"
        fit="true">
        <table fit="true">
            <tr>
                <td style="height: 150px; text-align: center">
                    <a href="#" class="easyui-linkbutton" iconcls="icon-ok" onclick="rightMoveClick()">右移==></a>
                </td>
            </tr>
            <tr>
                <td style="height: 150px; text-align: center">
                    <a href="#" class="easyui-linkbutton" iconcls="icon-ok" onclick="leftMoveClick()"><==左移</a>
                </td>
            </tr>
        </table>
    </div>
    <div id="rightDiv" border="false" class="cart" region="east" style="width: 358px;
        border-left-width: 1px;">
        <table id="checkProductTable" class="easyui-datagrid" border="false" url='' singleselect="false"
            fit="true" rownumbers="true">
            <thead>
                <tr>
                    <th field="ck" checkbox="true">
                        <th field="ProductCode" width="120">
                            产品编码
                        </th>
                        <th field="ProductName" width="170">
                            产品名称
                        </th>
                </tr>
            </thead>
        </table>
    </div>
</div>
