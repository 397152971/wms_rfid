<script type="text/javascript">
    function settleClick() {
        var row = $('#details').datagrid('getSelected');
        if (row) {
            $.messager.confirm('结单', '确认要结单吗？未作业的数据结单后将无法在操作！结单有风险！操作需谨慎！', function (r) {
                if (r) {
                    $.getJSON('/SortWorkDispatch/Settle/', { id: row.ID }, function (json) {
                        if (json) {
                            if (json.success) {
                                $.messager.show({
                                    title: '成功',
                                    msg: json.msg
                                });
                                $('#details').datagrid('load');
                            } else {
                                $.messager.show({
                                    title: '错误',
                                    msg: json.msg
                                });
                                $('#details').datagrid('load');
                            }
                        }
                    });
                }
            });
        } else {
            $.messager.confirm('错误', '没有选择行，无法结单！');
        }
    }
</script>

