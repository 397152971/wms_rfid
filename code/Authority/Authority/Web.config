<?xml version="1.0" encoding="utf-8"?>
<!--
  有关如何配置 ASP.NET 应用程序的详细信息，请访问
  http://go.microsoft.com/fwlink/?LinkId=152368
  -->

<configuration>
  <configSections>
    <section name="unity" type="Microsoft.Practices.Unity.Configuration.UnityConfigurationSection,Microsoft.Practices.Unity.Configuration" />
  </configSections>
  <connectionStrings>
    <add name="AuthorizeEntities" connectionString="metadata=res://*/EntityModels.AuthorizeDBModel.csdl|res://*/EntityModels.AuthorizeDBModel.ssdl|res://*/EntityModels.AuthorizeDBModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=.;Initial Catalog=Authorize;Integrated Security=True;MultipleActiveResultSets=True;Application Name=EntityFramework&quot;" providerName="System.Data.EntityClient" />   
  </connectionStrings>

  <appSettings>
    <add key="ClientValidationEnabled" value="true"/> 
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/> 
  </appSettings>

  <system.web>
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>

    <authentication mode="None">
      <forms loginUrl="~/Account/LogOn" timeout="50000" />
    </authentication>

    <machineKey
      validationKey="EF936296B4B062FFD6B7074C0501D7CCEFB50C19A75613AEEC603B4EF5F42AEDC463FDE81707795DDAA5FD4AA0D88CC30E9D413699A7E814358876FC9E75B883"
      decryptionKey="948F668DFEEC39CB8BF07E222BFEED5C5B5B9FF427E0F92976534EE8D517F325"
      validation="SHA1"
      decryption="AES"
      />

    <membership>
      <providers>
        <clear/>
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
             enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
             maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
             applicationName="/" />
      </providers>
    </membership>

    <profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
      </providers>
    </profile>

    <roleManager enabled="false">
      <providers>
        <clear/>
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>

    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages"/>
      </namespaces>
    </pages>
    <customErrors mode="Off"/>
  </system.web>

  <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="HttpRequestModule" type="THOK.Authority.Dal.Infrastructure.HttpRequestModule, THOK.Authority.Dal"/>
    </modules>
  </system.webServer>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>

  <unity>
    <typeAliases>
      <!-- Lifetime manager types -->
      <typeAlias alias="singleton"
           type="Microsoft.Practices.Unity.ContainerControlledLifetimeManager,
               Microsoft.Practices.Unity" />
      <typeAlias alias="perThread"
           type="Microsoft.Practices.Unity.PerThreadLifetimeManager,
               Microsoft.Practices.Unity" />
      <typeAlias alias="external"
           type="Microsoft.Practices.Unity.ExternallyControlledLifetimeManager,
               Microsoft.Practices.Unity" />
    </typeAliases>
    <containers>
      <container name="containerOne">
        <types>
          <!-- Default (un-named) mapping for IDocumentService to DocumentService-->
        </types>
      </container>
      <container name="defaultContainer">
        <register type="THOK.Security.IFormsAuthenticationService, Authority" mapTo="THOK.Security.FormsAuthenticationService, Authority"/>
        <register type="THOK.Authority.Bll.Interfaces.Authority.IUserService, THOK.Authority.Bll" mapTo="THOK.Authority.Bll.Service.Authority.UserService, THOK.Authority.Bll"/>
        <register type="THOK.Authority.Bll.Interfaces.Authority.IModuleService, THOK.Authority.Bll" mapTo="THOK.Authority.Bll.Service.Authority.ModuleService, THOK.Authority.Bll"/>
        <register type="THOK.Authority.Bll.Interfaces.Authority.IRoleService, THOK.Authority.Bll" mapTo="THOK.Authority.Bll.Service.Authority.RoleService, THOK.Authority.Bll"/>
        <register type="THOK.Authority.Bll.Interfaces.Authority.ISystemService, THOK.Authority.Bll" mapTo="THOK.Authority.Bll.Service.Authority.SystemService, THOK.Authority.Bll"/>
        <register type="THOK.Authority.Bll.Interfaces.Authority.ICityService, THOK.Authority.Bll" mapTo="THOK.Authority.Bll.Service.Authority.CityService, THOK.Authority.Bll"/>
        <register type="THOK.Authority.Bll.Interfaces.Authority.IServerService, THOK.Authority.Bll" mapTo="THOK.Authority.Bll.Service.Authority.ServerService, THOK.Authority.Bll"/>

        
        
        <register type="THOK.Authority.Dal.Interfaces.Authority.IAuthorityRepositoryContext, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.Infrastructure.RepositoryContext.AuthorityRepositoryContext, THOK.Authority.Dal"/>
                
        <register type="THOK.Authority.Dal.Interfaces.Authority.IRoleRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.RoleRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IUserRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.UserRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.ICityRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.CityRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IServerRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.ServerRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.ISystemRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.SystemRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IModuleRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.ModuleRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IFunctionRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.FunctionRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.ILoginLogRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.LoginLogRepository, THOK.Authority.Dal"/>

        <register type="THOK.Authority.Dal.Interfaces.Authority.IUserSystemRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.UserSystemRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IUserModuleRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.UserModuleRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IUserFunctionRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.UserFunctionRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IUserRoleRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.UserRoleRepository, THOK.Authority.Dal"/>

        <register type="THOK.Authority.Dal.Interfaces.Authority.IRoleSystemRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.RoleSystemRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IRoleModuleRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.RoleModuleRepository, THOK.Authority.Dal"/>
        <register type="THOK.Authority.Dal.Interfaces.Authority.IRoleFunctionRepository, THOK.Authority.Dal" mapTo="THOK.Authority.Dal.EntityRepository.Authority.RoleFunctionRepository, THOK.Authority.Dal"/>
      </container>
    </containers>
  </unity>
</configuration>
